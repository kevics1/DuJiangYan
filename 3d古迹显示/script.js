 // 配置数据
 const token = '291518e43f07e5e9984dd3eab8ed6bb1';
 const tdtUrl = 'https://t{s}.tianditu.gov.cn/';
 const subdomains = ['0','1','2','3','4','5','6','7'];
 const siteData = {
   "宝瓶口": {
     images: ["images_guji/宝瓶口_1.png", "images_guji/宝瓶口_2.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;宝瓶口起“节制闸”作用，是前山(今名灌口山、玉垒山)伸向岷江的长脊上凿开的一个口子，是人工凿成控制内江进水的咽喉，因它形似瓶口而功能奇持，故名宝瓶口。留在宝瓶口右边的山丘，因与其山体相离，故名离堆。离堆在开凿宝瓶口以前，是湔山虎头岩的一部分。由于宝瓶口自然景观瑰丽，有“离堆锁峡”之称，属历史上著名的“灌阳十景”之一。", "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;宝瓶口作为最后一道关卡，其最重要的作用为‘引清排浑’。机理如下：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第一，弯道水流有纵向流速，也有弯道环流，故水流在弯道中会形成螺旋流：在水流顺江向下，较清澈的表层流流向凹岸（宝瓶口），浑浊的底层流流向凸岸（飞沙堰），宝瓶口正对表层流流向，为’正面引水’的姿态，同时在河道螺旋流的作用下，挟带泥沙的底层流从堰顶翻越到外江。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第二，由于宝瓶口为收窄断面，在收窄处会形成回流，如图所示，在回流作用下，泥沙会被甩到飞沙堰上。"]
   },
   "城隍庙": {
     images: ["images_guji/城隍庙.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;城隍，起源于古代的水(隍)庸(城)的祭祀，为儒教《周宫》八神之一。‘城’原指挖土筑的高墙，‘隍’原指没有水的护城壕。古人造城是为了保护城内百姓的安全，所以修了高大的城墙、城楼、城门以及壕城、护城河。他们认为与人们的生活、生产安全密切相关的事物，都有神在，于是城和隍被神化为城市的保护神。道教把它纳入自己的神系，称它是剪除凶恶、保国护邦之神，并管领阴间的亡魂。城隍下辖有文武判官、各司大神、甘柳将军、范谢将军、牛马将军、日夜游神、枷锁将军等神。 <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;城隍庙则为祭祀城隍的寺庙，作用在于振兴教化、劝人向善。如都江堰城隍庙内有对联曰：“彰瘅本无私，明明白白，举念时毋欺了自己；贤奸终有报，是是非非，到头处曾放过谁人？”“善恶界几希，莫到此间才转念；阴阳同鉴察，须寻原处早回头”，这就充分概括了城隍庙的宗旨。 <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;都江堰城隍庙位于国家AAAAA级风景名胜区内，与全国重点文物保护单位都江堰相邻的玉屏山麓，背山面城而建，海拔760米。此间峰峦耸秀，楠柏葱茏，如翠屏高列。庙左小擂鼓坪，“结束万山，形如伏龟，陡落平野，直达省门”，故又名“金龟山”；庙右斗犀台，台下宝瓶飞波，如银山道卷，滚雪飞花。庙后山脊为古城垣，宛若游龙腾空；玉屏山“一峰突起，直趋县治”（民国《灌县志》）。城区主干道幸福路直达庙门，松茂古道及游山小道遍及山林之间。 <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;城隍庙始建不详。据清乾隆《灌县志•祠庙》言：顺治年间（1644年-1661年）厉坛，雍正三年（1726年）“添设饭米”。由此可见其庙建于明代。《重修城隍庙碑》载，乾隆四十七年（1782年）住持道士张来翕“庀材鸠工，大兴土木，重建殿宇”，并“广栽繁茂，力谨护持”。至此，城隍庙山林、庙宇一片兴旺。光绪三年（1877年）庙遭火灾，次年由知县陆葆德主持重建。 <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;城隍庙建筑群座北向南、背山面城，占地面积3000平方米，建筑面积1374平方米，穿斗式木梁架、歇山顶建筑，建筑群依山势分上下两区。上区马王殿、城隍殿、娘娘殿等，建于山窝台地上，依等高线向东西两面横向展开；下区十龙殿、灵官楼等建于山脚松茂古道旁，沿踏道方向纵向延伸。所有建筑中，十龙殿布局最具匠心，布置在一条笔直上行梯道两侧，呈对称跌落布局，各间相邻的山墙出屋面飞檐为二重、三重相间，疏密得宜，错落有序，似群雁展翅，给人以深刻印象。该建筑收录入清华大学建筑学教材，具有很高的历史意义和考古价值。"]
   },
   "二王庙": {
     images: ["images_guji/二王庙_1.png","images_guji/二王庙_2.png","images_guji/二王庙_3.png","images_guji/二王庙_4.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;二王庙，位于四川省成都市都江堰岷江东岸的玉垒山麓，是纪念古代水利名家李冰父子的祀庙，是世界文化遗产都江堰的重要组成部分。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;据文献记载，古代岷江时常泛滥成灾。战国秦昭王时蜀郡守李冰及其子率众开凿都江堰，调控江水，使整个成都平原既得灌溉、舟楫之利，又免水患、干旱之苦。二王庙原为望帝祠，百姓所缅怀和敬仰更名为崇德庙，宋以后，李冰父子相继被敕封为王，改称为二王庙。民国十四年（1925年）曾遭火焚，灾后募资重建。二王庙顺应山势，建筑主轴线呈现西南东北走向，为合院式布局。同时，设计者集巧思，转换山门前序院落空间，偏置入口，反而形成极有特色的“山门院落”。现占地面积约10000平方米，建筑面积约6000平方米。 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2018年，二王庙古建筑群灾后抢救保护工程获国家文物局授予的’优秀文物保护工程特别奖’。此外，修复工程还获得了’联合国教科文组织亚太地区文化遗产保护奖’’国家传统建筑文化保护示范工程’等奖项。","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;从正山门乐楼起，二王庙有主殿三重，配殿十六重，规模宏大。殿宇布局不受中轴线束缚，而是因地制宜，依山就势，高低错落，起伏有序。庙宇前部，有清末绘制的都江堰灌区流域图，赞颂李冰父子的匾联碑刻。中部有李冰治水六字诀‘深淘滩，低作堰’石刻。后部有李冰殿和二郎殿。 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;二王庙建筑群最突出的风格是不强调中轴对称。庙宇完全依照自然地理环境，上下重叠交错建设，建筑上下高差达50米左右，形成庙台叠起、曲廊连环的建筑风格。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;从下往上看，登临一层，上面还有建筑；从上往下看，殿宇重重，错落有致。二王庙的入口为东西方向的长形院落，与岷江河道同一方向，是松茂古道的一部分。临江面有疏江亭、小筑三楹及照壁小舍。疏江亭损毁后修成一整面围墙，上面绘有都江堰灌区图。台上有乐楼，重檐歇山层面。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;两边均有配殿，东边为青龙殿，西侧为白虎殿。转而再登上台阶，便到三官殿、观澜亭下，游人可在此停步抬头仰望。台阶两侧的墙壁上镶嵌着历代的一些治水格言。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自三官殿、观澜亭前向左登几十级台阶，达灵官殿前侧。灵官殿北侧有“乘势利导，因时制宜”八字。这八字既体现出修建都江堰的原理，又符合二王庙的修建原理。二王庙的治水格言不仅成为一景，而且具有向游览者科普的作用。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;早在战国时期，这些治水格言就被镌刻在都江堰旁的山体上，让当地的百姓能世代遵循，保护、维修都江堰。自灵官殿再向右转便可到达主景区李冰殿前。台阶前，可看见照壁上邓小平题写的‘造福万代’四字。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;主殿由李冰殿和二郎殿组成，一前一后，建筑屋檐上都写满治水名言。二郎殿的对面是一处戏台，每年李冰生日之时，会在此处表演。在院子西北处，环境相对较为开敞，西侧有娘娘殿，后来将其改为堰功祠，祭祀一些有功于都江堰的前贤。再向西北登石级蜿蜒而上，上面为圣母殿。穿飞楼再向上，可到达老君殿等地，这是二王庙中最高的地段。此地居高临下，视线开阔，往下可俯视二王庙的重重建筑，远眺可见岷江的滔滔江水和都江堰旁的层层山脉，是观赏风景的绝佳位置。","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;庙门前壁上有清代末年绘制的《都江堰灌溉区域图》，是极为珍贵的历史资料。庙内观澜亭下，一排丹墙石壁上镌刻着两则治水《三字经》。一则为清同治十三年（1874年）灌县知县胡圻依据历代都江堰治水经验编成的《三字经》。另一则是清光绪三十二年（1906年），成都府知文焕对原《三字经》作修改，又重刻于二王庙石壁上。内容是：‘深掏滩，低作埝。六字旨，千秋鉴。挖河沙，堆堤岸。砌鱼嘴，安羊圈。立湃阙，留漏罐。笼编密，石装健。分四六，平潦旱。水画符，铁桩见。岁勤修，预防患。遵旧制，毋擅变。’后人总结的治水《八字经》：‘乘势利导，因时制宜’、‘具湾截角，逢正抽心’被认为是饱含哲理的治水真谛，至今广为传颂。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;此外，二王庙文物众多，殷商古木、精美碑刻……沉静大美，赋予了二王庙独特的气场和底蕴，同时为这里增添些许神秘感。在二殿一侧，有文物陈列室，内陈有清乾隆款通山庵铁铭文钟、乾隆哮天犬、张大千绘‘玉女’，关山月绘‘黄粱梦’图石碑、徐悲鸿‘天马’，‘奔马’图石碑、董其昌书《岳阳楼记》木刻等。","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;三官殿墙壁上嵌刻的“深淘滩，低作堰”即李冰传世治水六字诀。旁边嵌刻的治水八字格言及治水《三字经》，也无不告诫着后人须谨遵李冰的教诲，防患于未然。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;深淘滩：指每年岁修时，河床淘沙要淘到一定深度，淘得过深，宝瓶口进水量偏大，会造成涝灾；淘得过浅，宝瓶口进水量水量不足，难以保证灌溉。为此，相传李冰才在河床下埋石马，明代起改埋卧铁，作为深淘标志。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;低作堰：指飞沙堰在修筑时，堰顶宜低作，便于排洪排沙，起到“引水以灌田，分洪以减灾”的作用。切忌用高作堰的方式在枯水季节增加宝瓶口的进水，那是一种急功近利的做法，在洪水季节会造成严重淤积，使工程逐渐废弃。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;小平题字：三官殿同样有一照壁，其上有邓小平同志题写的“造福万代”四个大字。一个转身，正殿正门前，可以清楚看到“二王庙”3个金字，此为爱国将领冯玉祥将军题写的匾额。"]
   },
   "飞沙堰": {
     images: ["images_guji/飞沙堰_1.png","images_guji/飞沙堰_2.png","images_guji/飞沙堰_3.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;飞沙堰位于鱼形堤坝的尾部，是高出河床约2米的坝堰。飞沙堰是都江堰确保成都平原不受水灾的关键要害。它的主要作用是当内江的水量超过宝瓶口流量上限时，多余的水便从飞沙堰自行溢出；如遇特大洪水的非常情况，它还会自行溃堤，让大量江水回归岷江正流。另一作用是‘飞沙’，岷江从万山丛中急驰而来，挟着大量泥沙，石块，如果让它们顺内江而下，就会淤塞宝瓶口和灌区。飞沙堰真是善解人意、排人所难，将上游带来的泥沙和卵石，甚至重达千斤的巨石，从这里抛入外江（主要是巧妙地利用离心力作用），确保内江通畅，确有鬼斧神工之妙。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘深淘滩，低作堰’是都江堰的治水名言。淘滩是指飞沙堰一段、内江一段河道要深淘，深淘的标准是古人在河底深处预埋的‘卧铁’。岁修淘滩要淘到卧铁为止，才算恰到好处，才能保证灌区用水。低作堰就是说飞沙堰有一定高度，高了进水多，低了进水少，都不合适。","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;飞沙堰，顾名思义，作用就是排沙。在洪水季节，泥沙为何会从飞沙堰被甩出？平时轻松甩100斤卵石，1966年甚至甩出过2吨中的石块，简直逆天！下面介绍逆天排沙原理。首先介绍两个概念：弯道环流和凹冲凸淤。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;①弯道环流，水流过弯时，由于离心力作用，凹岸水位较高，如图所示。因为凹岸水位高，水深大，故凹岸底部水压力大<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=ρgh，在压力作用下凹岸底部水流向凸岸，形成了弯道横向环流。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;②凹冲凸淤，如图所示，在垂向上，泥沙浓度分布为上稀下浓。弯道环流+上稀下浓，底部浑水从凹到凸，上部清水从凸到凹，长此以往，凹冲凸淤。","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;现在可以解释飞沙堰的飞沙技能了，飞沙堰处于弯道河流，此处会形成弯道环流现象，在弯道环流作用下，清澈的表层流进入内江，浑浊的底层流带入外江。至于甩100斤巨石，由于挟沙力与流速U高次方成正比，故而，第二级排沙成功。"]
   },
   "伏龙观": {
     images: ["images_guji/伏龙观_1.png","images_guji/伏龙观_2.png"],
     texts: ["<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;伏龙观建在离堆之上，三面悬绝，一面用42级宽三丈一尺五寸石阶和开阔的大坝相连，使伏龙观显得特别雄伟庄严。主要建筑布置在一条中轴线上。建筑布局是：‘东临江口之关，故灵基立其左；西瞻宝室之穴，故仙亭峙其右。正居太上之殿，中筑朝真之坛。‘<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;伏龙观原有殿宇两重，清同治间建成李冰殿，共有主殿三重。1959年培修时，将玉皇殿、喜雨楼合并，改建为钢筋混凝土砖木排架。一楼一底的后殿。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;前殿陈列着1974年修建外江节制闸时从河床中挖出的李冰石刻像，高2.9米，重4.5吨。石像造于东汉灵帝初年，距今已1800多年，是我国现存最早的圆雕石像，非常珍贵。后殿陈列有都江堰灌区的电动模型。伏龙观的左侧是宝瓶口，江水奔腾澎湃，气势磅礴。观后最高处建有观澜亭，两层八角，凭栏远眺，可见鱼嘴、索桥及岷江激流、西岭雪峰。1973年重建了庙前带江亭等建筑，近年来，新辟了花榭等，方便了游客观赏‘离堆锁峡’风光。","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;伏龙观中文物甚多。树立在正殿中的东汉李冰圆雕石像，1974年迁建索桥时于三号桥基坑出土。像用灰白砂岩琢成，高290厘米，肩宽96厘米，厚46厘米，底部有一方榨，长18厘米。石像冠冕长衣，手置胸前，面含微笑，两袖和衣襟上各有浅刻题记一行。中行为：‘故蜀郡李府君讳冰‘；左为’建宁元年闰月戊申朔二十五日都水橡尹龙‘；右为’尹龙长陈台造三神石人瑜水万世焉‘。1975年8月18日加座竖立在伏龙观正殿中。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正殿右侧竖立的堰工石像，是1975年1月18日在都江堰外闸下开挖护滩时发现的。石像宽衣重袖，持插而立，通高1.85米，肩宽0.7米；插高0.28米，宽0.25米，插把长1.34米。石像头部已被冲毁，背部冲蚀严重，可能是李冰石像铭文中’三神石人‘之一，1975年8月18日树立在伏龙观大殿右侧。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正殿中的飞龙铁鼎，是唐容宗女玉真公主故物。鼎重约千斤，上有八条飞龙和云纹花卉，是不可多得的古代铸造精品。1978年10月移入观中陈列。"]
   },
   "奎光塔": {
     images: ["images_guji/奎光塔.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;奎光塔，是一座文峰塔，位于四川省都江堰市奎光路101号奎光塔公园内，西临岷江约1千米，东距安江河约600米。奎光塔始建于明代，重建于清道光十一年（1831年）。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;奎光塔高52.67米，重心高度23.22米，重约3460吨，是中国层数最多的古代砖塔。奎光塔平面为六角形，十七层，从外观来看极似密檐塔，实际却是一座楼阁式塔。奎光塔具有鲜明地方特色，有较高文物价值、艺术价值和观赏价值。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;奎光塔高52.67米，重心高度23.22米，重约3460吨，是中国层数最多的古代砖塔。奎光塔平面为六角形，十七层，从外观来看极似密檐塔，实际却是一座楼阁式塔。塔底有一正方形护台，护台边墙以条石干砌而成，边墙内以素土夯填。第一层塔身最高，建在一个方形大台基上，正面开券门，门上一石匾，塔檐做叠涩式，以上各层塔身逐渐缩短。塔各层六面都有采光、通风的壶门式小窗。塔檐、塔身次第内收，递收幅度逐层略微加大，使外廓微有卷曲。塔身挂有铁风铃，风吹铃响。塔内部各层有塔室，塔内有盘旋阶梯可上至七层，以上十层为中空，是一座壁内折上式结构的塔。奎光塔外形古朴壮观，十层以下为双简结构，内设螺旋形石梯，可登高。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;奎光塔塔基以上每层密檐均由12层青砖垒筑，有的青砖刻着‘清‘字或’清邑令周修‘的标识。奎光塔北面塔门匾额上书：道光十一年辛卯仲冬吉日‘奎光塔‘督学蒲田郭尚先书。"]
   },
   "离堆公园": {
     images: ["images_guji/离堆公园.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;离堆公园是成都市都江堰景点之一，占地90余亩，1932年建成。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;公园大门对联：‘完神禹斧椎功，陆海无双，河渠大书秦守惠；揽全蜀山水秀，导江第一，名园生色华阳篇。‘上联说，誉称’陆海‘的天府，盖世无双，归功于李冰太守，他接过大禹的神斧仙椎，完成了伟大的都江堰水利工程；下联说，总揽蜀中名山秀水，都江堰市第一，这离堆公园就是其中增色添彩的一处。2013年7月23日，离堆公园支线开通，下穿都江堰市区。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;公园内亭榭错落有致，古木桩头，奇花异卉，水池喷泉，布局精巧，别具情趣，园中有紫薇花瓶，紫薇屏风，经二三百年培育而成，独具匠心；这株古银杏桩头，传说为东汉末年张松手植，至今仍亭亭玉立，枝繁叶茂，像一支仙鹤，托这里山水的灵气，听说还结出了果实。紫薇花瓶、紫薇屏风和银杏桩，人称’园中三宝‘。 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;园中有紫薇花瓶，紫薇屏风，经二三百年培育而成，独具匠心。其中一株古银杏桩头，传说为东汉末年张松手植，至今仍亭亭玉立，枝繁叶茂。紫薇花瓶、紫薇屏风和银杏桩被称为’园中三宝‘。 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进园后往左边走就是清溪园。园内有全国罕见的上千年树桩盆景，也有再现巴山蜀水幽、险、雄、秀自然风貌的山水盆景。古朴的灯饰，布满岁月的痕迹，侧耳倾听小桥流水，在这布局唯美的空间中，仿佛读懂了时间的故事。"]
   },
   "秦堰楼": {
     images: ["images_guji/秦堰楼.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;秦堰楼，因都江堰建于秦国而得名。秦堰楼横跨内外两江，长500米。这里是眺望都江堰全景的最佳位置。秦堰楼依山而立，雄峙江岸，结构精巧，峻拨壮观。未建之前，这里是‘观景台‘，又称’幸福台‘，因毛泽东主席于1958年3月21日曾站在这个位置，仔细观看都江堰。在伏龙观和二王庙里陈列了这幅珍贵的照片。登上秦堰楼极目眺望，都江堰三大水利工程、安澜桥、二王庙、古驿道、玉垒雄关、岷岭雪山、青城群峰尽收眼底，甚为壮观。"]
   },
   "卧铁": {
     images: ["images_guji/卧铁.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卧铁，是埋在内江’凤栖窝’处的淘滩标准，也是内江每年维修清淘河床深浅的标志，位于四川都江堰的景点。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卧铁，作为都江堰岁修淘滩的标尺，确保每年枯水期清淤深度适中，保障成都平原灌溉与防洪，是都江堰治水智慧的重要体现。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卧铁主要是用来标记挖掘深度的。由于都江堰遵从李冰的’深淘滩，低作堰’原则，在从古至今，每年枯水期都要对河道清除淤积的泥沙。那到底挖泥沙挖到多深合适呢？经过人们的经验，找出了一个合适的深度，并埋上卧铁。以后岁修就挖到卧铁为止。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;相传李冰建堰时在内江河床下埋有石马，作为每年淘滩深度的标准，后来演变为卧铁。卧铁与“深淘滩、低作堰”的6字水则,以及’遇湾截角,逢正抽心’的8字格言,是都江堰岁修淘滩的尺度。岁修清淤时必须淘够深度，以淘至见到卧铁为准，如果淘滩深度不够，内江河床太高，将减少成都平原来年春灌引水量，而如果淘滩过深，则会使过量的洪水涌入内江，导致内江灌区洪涝灾害。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卧铁至今留存4根。最早铸于明代万历三年(1575年)，由四川御使巡按郭庄主持铸置。"]
   },
   "仰天窝廊桥": {
     images: ["images_guji/仰天窝廊桥.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;仰天窝廊桥又名仰天窝节水闸，是都江堰内江河上第一座调节分流的重要水利设施，内江经宝瓶口流经南桥后，在仰天窝鱼嘴一分为二，西去的走江河干渠经走江闸分出走马河和江安河，东去的蒲柏河干渠经蒲柏闸分出蒲阳河和柏条河，仰天窝节水闸于1963年冬修建，共分6孔，蒲柏河干渠和走江河干渠各3孔，闸室每孔净宽9米，采用单轨电动行车移动启闭。仰天窝节水闸横跨内江总干渠之上，与都江堰这座山水城市相呼应，总控内江，利益天府，被誉为西蜀第一闸。"]
   },
   "玉垒关": {
     images: ["images_guji/玉垒关.png"],
     texts: ["&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;玉垒关：又名’其盘关’，玉垒关用条石和泥浆砌成，长13.29米，宽6.86米，高6.2米。关门联语十分精妙’玉垒峙雄关，山色平分江左右；金川流远派，水光清绕岸东西’。它是古代川西平原的要隘，也是千余年来古堰旁的一处胜景，故称’川西锁钥’。 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;玉垒关是古代屏障川西平原的要隘，也是千余年来古堰旁的一处胜景。早在三国时期玉垒关就作为城防，不过那时还是相对简陋的。真正意义上的建关是在唐朝贞观年间，当时唐朝与吐蕃之间一直是战争与和平交替出现的年代，唐为了安稳疆土便在川西和吐蕃接壤的通道上设置关隘作为防御的屏障。玉垒关就是在这样的背景下修建的。这道关口象是在成都平原与川西北高原之间加上的一把锁，被誉为’川西锁钥’，为保证成都平原的和平稳定发展发挥了极大的作用。"]
   }

 };

 // 初始化地图
 window.viewer = new Cesium.Map('cesiumContainer', {
   shouldAnimate: true,
   baseLayerPicker: false,
   timeline: false
 });

 // 添加天地图服务
 viewer.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({
   url: tdtUrl + 'DataServer?T=img_w&x={x}&y={y}&l={z}&tk=' + token,
   subdomains: subdomains,
   tilingScheme: new Cesium.WebMercatorTilingScheme()
 }));

 // 添加地形服务
 const terrainUrls = subdomains.map(s =>
   tdtUrl.replace('{s}', s) + 'mapservice/swdx?T=elv_c&tk=' + token
 );
 viewer.terrainProvider = new Cesium.GeoTerrainProvider({ urls: terrainUrls });

 // 加载古迹点数据
 fetch('data/古迹点.geojson')
   .then(res => res.json())
   .then(async geojson => {
     const features = geojson.features;
     const positions = [];

     for (const feature of features) {
       const [lon, lat] = feature.geometry.coordinates;
       const name = feature.properties.name || '未知';

       // 精确地形采样
       const cartoPos = Cesium.Cartographic.fromDegrees(lon, lat);
       const terrainSample = await Cesium.sampleTerrainMostDetailed(
         viewer.terrainProvider, 
         [cartoPos]
       );
       const baseHeight = terrainSample[0].height;

       // ========== 基准坐标计算 ==========
       const basePosition = Cesium.Cartesian3.fromDegrees(lon, lat, baseHeight + 2); // 地形高度基准点
       positions.push(basePosition);

       // ========== 圆形标记实体（点） ==========
       const pointHeight = baseHeight + 10; // 调高圆点高度
       viewer.entities.add({
         name: name + '_点标记',
         position: Cesium.Cartesian3.fromDegrees(lon, lat, pointHeight),
         point: {
           pixelSize: 5,
           color: Cesium.Color.RED,
           outlineColor: Cesium.Color.WHITE,
           outlineWidth: 2,
           heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,
           pixelOffset: new Cesium.Cartesian2(0, -10) // 向下偏移
         },
         siteName: name // 添加唯一标识符
       });

       // ========== SVG图标实体（提升到25米高度） ==========
       const svgPosition = Cesium.Cartesian3.fromDegrees(lon, lat, baseHeight + 25);
       viewer.entities.add({
         name: name + '_图标',
         position: svgPosition,
         billboard: {
           image: `svg/${encodeURIComponent(name)}.svg`,
           width: 40,
           height: 40,
           verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
           disableDepthTestDistance: Number.POSITIVE_INFINITY,
           heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,
           pixelOffset: new Cesium.Cartesian2(0, -20) // 向上偏移
         },
         siteName: name // 添加唯一标识符
       });

       // ========== 文字标签（优化显示） ==========
       const labelPosition = Cesium.Cartesian3.fromDegrees(lon, lat, baseHeight + 30);
       viewer.entities.add({
         name: name + '_文字',
         position: labelPosition,
         label: {
           text: name,
           font: '14px sans-serif',
           fillColor: Cesium.Color.WHITE,
           outlineColor: Cesium.Color.BLACK,
           outlineWidth: 2,
           style: Cesium.LabelStyle.FILL_AND_OUTLINE,
           verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
           horizontalOrigin: Cesium.HorizontalOrigin.CENTER,
           pixelOffset: new Cesium.Cartesian2(0, -10), // 向上偏移
           disableDepthTestDistance: Number.POSITIVE_INFINITY,
           heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,
           scaleByDistance: new Cesium.NearFarScalar(1000, 1.0, 5000, 0.5) // 视距缩放
         },
         siteName: name // 添加唯一标识符
       });
     }

     // 绑定点击事件
     viewer.screenSpaceEventHandler.setInputAction(movement => {
       const pickedObject = viewer.scene.pick(movement.position);
       if (pickedObject && pickedObject.id && pickedObject.id.siteName) {
         showInfo(pickedObject.id.siteName);
       }
     }, Cesium.ScreenSpaceEventType.LEFT_CLICK);

     // 调整视角
     const boundingSphere = Cesium.BoundingSphere.fromPoints(positions);
     viewer.camera.flyToBoundingSphere(boundingSphere, {
       duration: 3,
       offset: new Cesium.HeadingPitchRange(
         Cesium.Math.toRadians(0),
         Cesium.Math.toRadians(-35),
         boundingSphere.radius * 2.5
       )
     });
   });

    // 初始视角设置
 viewer.camera.setView({
  destination: Cesium.Cartesian3.fromDegrees(104.1, 30.6, 3700000),
  orientation: {
    heading: Cesium.Math.toRadians(0),
    pitch: Cesium.Math.toRadians(-60),
    roll: 0
  }
});
function showInfo(name) {
  const data = siteData[name] || { images: [], texts: [] };
  const carouselElement = document.getElementById('imageCarousel');
  const textContainer = document.getElementById('textContent');
  
  // 销毁现有轮播实例
  const existingCarousel = bootstrap.Carousel.getInstance(carouselElement);
  if (existingCarousel) existingCarousel.dispose();

  // 清空内容
  const carouselInner = document.getElementById('carouselInner');
  carouselInner.innerHTML = '';
  textContainer.innerHTML = '';

  // 创建统一尺寸的轮播项
  data.images.forEach((img, index) => {
    // 轮播项（移除标题，添加固定尺寸容器）
    carouselInner.innerHTML += `
      <div class="carousel-item ${index === 0 ? 'active' : ''}">
        <div class="image-container">
          <img src="${img}" class="scaled-image">
        </div>
      </div>`;
    
    // 文本块
    textContainer.innerHTML += `
      <div class="text-item ${index === 0 ? 'active' : 'd-none'}">
        <h4>${name}</h4>
        <p>${data.texts[index] || '暂无描述'}</p>
      </div>`;
  });

  // 初始化轮播
  const carousel = new bootstrap.Carousel(carouselElement, {
    interval: 5000,
    touch: true,
    wrap: true
  });

  // 轮播切换事件
  carouselElement.addEventListener('slide.bs.carousel', event => {
    const activeIndex = event.to;
    textContainer.querySelectorAll('.text-item').forEach((item, i) => {
      item.classList.toggle('d-none', i !== activeIndex);
      item.classList.toggle('active', i === activeIndex);
    });
  });

  // 固定模态框尺寸
  const modalDialog = document.querySelector('.modal-dialog');
  modalDialog.style.maxWidth = '800px'; // 统一宽度
  modalDialog.style.minWidth = '300px';

  // 显示模态框
  new bootstrap.Modal(document.getElementById('infoModal')).show();
}